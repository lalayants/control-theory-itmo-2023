\documentclass[16pt]{article}

\usepackage{report}

\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[english, russian]{babel}
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage[colorlinks=true, linkcolor=black, citecolor=blue, urlcolor=blue]{hyperref}       % hyperlinks
\usepackage{url}            
\usepackage{booktabs}       
\usepackage{amsfonts}       
\usepackage{nicefrac}      
\usepackage{microtype} 
\usepackage{graphicx}
\usepackage{natbib}
\usepackage{doi}
\usepackage{mathtools}
\usepackage{minted}
\usepackage{graphicx}
\graphicspath{ {./figs/} }


\setcitestyle{aysep={,}}



\title{ЛР \textnumero 2 <<Переходные процессы, свободное движение, устойчивость>>}

\author{
Студент \\
Кирилл Лалаянц\\
R33352\\
336700\\
Вариант - 6\\
\\
Преподаватель\\
Пашенко А.В. \\
\\
\\
Факультет Систем Управления и Робототехники\\
\\
ИТМО\\
}

% Uncomment to remove the date
\date{13.09.2023}

% Uncomment to override  the `A preprint' in the header
\renewcommand{\headeright}{ЛР \textnumero 2 <<Переходные процессы, свободное движение, устойчивость>>}
\renewcommand{\undertitle}{Отчет}
\renewcommand{\shorttitle}{}


\begin{document}
\maketitle
\newpage
\tableofcontents
\thispagestyle{empty}

\newpage
\setcounter{page}{1}
\section{Вводные данные}
\subsection{Цель работы}
В этой работе будет проведенно исследование следующих вопросов:
\begin{itemize}
    \item Характер свободного поведения системы в зависимости от корней ее характеристического уравнения. 
    \item Исследования границ зоны устойчивости конкретной системы. 
    \item Создание автономного генератора для воссаздания поведения системы. 
    \item Изучение фазовых портретов канонической управляемой формы.
\end{itemize} 

\subsection{Инициализация необходимых переменных в Python}
Импорт необходимых библиотек (для реализации здесь и далее используется \href{https://python-control.readthedocs.io}{Python Control Systems Library}); инициализация массива временных отметок:
\begin{minted}[linenos, fontsize=\footnotesize,numbersep=5pt, frame=lines, framesep=2mm]{python}
import matplotlib.pyplot as plt
import numpy as np
import control 
import sympy
import os
import math
\end{minted}

\newpage
\section{Выполнение работы}
\label{sec:headings}


\subsection{Задание 1. Свободное движение.}

\subsubsection{Теория}
Хотим получить ДУ системы вида:
\[\ddot{y} + a_1\dot{y} + a_0y = u\]
Cначала получим характеристическое уравнение для частного решения вида:
\[\ddot{y} + a_1\dot{y} + a_0y = 0\]
Имеем два корня -- \(\lambda_1\) и \(\lambda_2\). Тогда:
\[ (p - \lambda_1)(p-\lambda_2) = p^2 - (\lambda_1 + \lambda_2)p + \lambda_1\lambda_2 = 0,\]
умножив которое на \(y\) получаем:
\[\ddot{y} + (\lambda_1 + \lambda_2)\dot{y} + \lambda_1\lambda_2y = 0.\]

Для данного ДУ известно частичное решение:
\[ y_{0}(t) = c_1 e^{\lambda_1 t} + c_2 e^{\lambda_2 t},\]
параметры \(c_1\) и \(c_2\) которого вычисляются из начальных условий.
\\
Также подставим характеристическое уравнение в знаменатель TF \(W(p)\):
\[W(p) = \frac{1}{p^2 - (\lambda_1 + \lambda_2)p + \lambda_1\lambda_2}\]
Полученная TF соотвествует системе с желаемыми корнями характеристического уравнения.
\subsubsection{Программная реализация}
\begin{minted}[linenos, fontsize=\footnotesize,numbersep=5pt, frame=lines, framesep=2mm]{python}
def task1_output(m1, m2, initial_value, ts, plot_name, save_name):
    poly = sympy.simplify((p - m1) * (p - m2))
    coeffs = sympy.Poly(poly, p).all_coeffs()
    
    ss = control.tf2ss(control.tf(1, np.array(coeffs, dtype=np.float64)))
    ss_reachable = control.canonical_form(ss, form="reachable")[0]

    tf2_y_0_0 = control.forced_response(ss_reachable, U=0, X0=[0, 0], T=ts)
    tf2_y_1_1 = control.forced_response(ss_reachable, U=0, X0=initial_value, T=ts)
    plot_task1(tf2_y_0_0, tf2_y_1_1, initial_value, ts, plot_name, save_name)
\end{minted}

\subsubsection{Результаты}
\begin{itemize}
    \item Устойчивая и неустойчивая апереодические моды 
    

    Выбраны \(\lambda_1 = -1\) и \(\lambda_2 = 1\). Получено уравнение свободного движения вида:
    \[y_0(t)= c_1 e^{-t} + c_2 e^t\]
    Из аналитического решения видно, что система, при отличных от 0 начальных условиях, со временем стремится к бесконечноcти, следовательно -- неустойчива.
    
    
    Проверим моделированием:

    \begin{figure}[H]
        \centering
        \includegraphics[width=\textwidth]{task1_2}
        \caption{Результаты устойчивой и неустойчивой апереодических мод.}
        \label{fig:fig1}
    \end{figure}

    Действительно, все так.

    \item Нейтральная и неустойчивая апереодические моды 
    
    
    Выбраны \(\lambda_1 = 0\) и \(\lambda_2 = 1\). Получено уравнение свободного движения вида:
    \[y_0(t)= c_1 e^{-t} + c_2\]
    Из аналитического решения видно, что система, при отличных от 0 начальных условиях, со временем стремится к бесконечноcти, следовательно -- неустойчива.
    
    
    Проверим моделированием:

    \begin{figure}[H]
        \centering
        \includegraphics[width=\textwidth]{task1_4}
        \caption{Результаты нейтральной и неустойчивой апереодических мод.}
        \label{fig:fig2}
    \end{figure}

    Действительно, все так.

    \item Пара консервативных мод
    
    
    Выбраны \(\lambda_1 = i\) и \(\lambda_2 = -i\). Получено уравнение свободного движения вида:
    \[y_0(t)= c_1 cos(t) + c_2 sin(t)\]
    Из аналитического решения видно, что система, при отличных от 0 начальных условиях, устойчива по Ляпунову.
    
    
    Проверим моделированием:

    \begin{figure}[H]
        \centering
        \includegraphics[width=\textwidth]{task1_6}
        \caption{Результаты пары консервативных мод.}
        \label{fig:fig3}
    \end{figure}

    Действительно, все так.
\end{itemize}



\newpage
\subsection{Задание 2. Область устойчивости. }
\subsubsection{Теория}
Возьмем первый набор корней из первого задания \(\lambda_1 = -1\) и \(\lambda_2 = 1\).
Представим соответсвующие им TF вида:
\[W(p) = \frac{1}{Tp + 1}\]
Получаем:
\[W_1(p) = \frac{1}{T_1p + 1} = \frac{1}{-1T_1 + 1} \rightarrow T1 = 1\]
\[W_2(p) = \frac{1}{T_2p + 1} = \frac{1}{1T_2 + 1} \rightarrow T2 = -1\]

Так же по задание имеем:
\[W_3(p) = \frac{1}{p}\]
\[W_4(p) = K\]
\[W_{feedback}(p) = -1\]

Тогда получаем общую TF cистемы:
\[W(p) = \frac{W_1(p)W_2(p)W_3(p)W_4(p)}{1 + W_1(p)W_2(p)W_3(p)W_4(p)} = \frac{K}{T_1T_2p^3 + (T_1+T_2)p^2+p+K}\]

Для анализа устойчивости воспользуемся следствием из критерия Гурвица для однородного ДУ третьего порядка:

\[
    \begin{cases}
        \frac{K}{T_1T_2} > 0 \\
        \frac{T_1+T_2}{T_1T_2} > 0\\ 
        \frac{K}{T_1T_2} > 0\\ 
        \frac{T_1+T_2}{(T_1T_2)^2} > \frac{K}{T_1T_2}
    \end{cases},
\]

\begin{itemize}
    \item Зафиксируем значение \(T_2 = -1\)
    
    Тогда система принимает вид: 
    \[
    \begin{cases}
        \frac{K}{T_1(-1)} > 0 \\
        \frac{T_1+(-1)}{T_1(-1)} > 0\\ 
        \frac{K}{T_1(-1)} > 0\\ 
        \frac{T_1+(-1)}{(T_1(-1))^2} > \frac{K}{T_1(-1)}
    \end{cases},
    \]
    решений у неё нет. Следовательно, система не может быть устойчивой с таким параметром \(T_2\).

    \item Зафиксируем значение \(T_1 = 1\)
    
    Тогда система принимает вид: 
    \[
    \begin{cases}
        \frac{K}{T_2} > 0 \\
        \frac{T_2+1}{T_2} > 0\\ 
        \frac{K}{T_2} > 0\\ 
        \frac{T_2+1}{T_2^2} > \frac{K}{T_2}
    \end{cases},
    \]
    у нее есть решения, представленные на графике ниже.
    \begin{figure}[H]
        \centering
        \includegraphics[width=\textwidth]{task2_T2_K}
        \caption{Зависимость устойчивости от K и \(T_2\).}
        \label{fig:fig4}
    \end{figure}
\end{itemize}

\subsubsection{Результаты}
По приведенным ниже графикам видно, что полученная выше зона устойчивости соответсвует действительности.
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{task2_conservative}
	\caption{Устойчивые по Ляпунову параметры.}
	\label{fig:fig5}
\end{figure}
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{task2_stable}
	\caption{Устойчивые ассимптотически параметры.}
	\label{fig:fig6}
\end{figure}
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{task2_not_stable}
	\caption{Неустойчивые параметры.}
	\label{fig:fig7}
\end{figure}

\newpage
\subsection{Задание 3. Автономный генератор.}
\subsubsection{Теория}
Необходимо найти матрицы \(A\) и \(C\) такие, чтобы выход системы совпадал с функцией:
\[y(t) = cos(5t) + e^t + e^{-5t}\]

Из функции ясно видно, что модами будут:
\(\lambda_1 = 1; \lambda_2 = -5; \lambda_3 = 5i; \lambda_4 = -5i.\)

Напишем Жорданову матрицу:
\[
    A = \begin{bmatrix}
    1 & 0 & 0 & 0 \\
    0 & -5 & 0 & 0 \\
    0 & 0 & 0 & 5 \\
    0 & 0 & -5 & 0 \\
    \end{bmatrix},
\]

\subsubsection{Программная реализация}
\begin{minted}[linenos, fontsize=\footnotesize,numbersep=5pt, frame=lines, framesep=2mm]{python}

\end{minted}

\subsubsection{Результаты}
\begin{figure}[H]
	\centering
	\includegraphics[width=\textwidth]{task1_2}
	\caption{Результаты третьего задания.}
	\label{fig:fig3}
\end{figure}
Видно, что графики выхода начинаются не в 0. Это связано с тем, что система не strictly-proper (то есть степени полиномов числителя и знаменятеля равны). Следствие этого заметно при переводе системы в формат SS: 
\[ A = \begin{bmatrix}
    -1.67
    \end{bmatrix},
    B = \begin{bmatrix}
        -0.607 & -0.794
        \end{bmatrix},
    C = \begin{bmatrix}
        0.594 \\
        -7.73
        \end{bmatrix},
    D = \begin{bmatrix}
        0.167 & 0.0833 \\
        -0.167 & -0.0833
        \end{bmatrix};
\]
Матрица связи D получается не нулевой, в связи с чем выход начинает зависеть не только от внутреннего состояния системы через матрицу наблюдения C, но и от входного взаимодействия через матрицу связи D.

\newpage
\subsection{Задание 4. Одноканальная система в форме вход-состояние-выход.}
\subsubsection{Теория}
Необходимо промоделировать SISO систему в формате SS:
\[ 
    \begin{cases}
        \dot{x} = Ax + Bu \\
        y = Cx + Du \\
    \end{cases},
\]
где:

\[ 
    A = \begin{bmatrix}
        0 &  -9 \\
        1 &  -6 
        \end{bmatrix},
        B = \begin{bmatrix}
            1 \\
            5
            \end{bmatrix},
        C = \begin{bmatrix}
            2 & 5
            \end{bmatrix},
        D = \begin{bmatrix}
            0
            \end{bmatrix};
\]

\subsubsection{Программная реализация}
\begin{minted}[linenos, fontsize=\footnotesize,numbersep=5pt, frame=lines, framesep=2mm]{python}
# Создание системы из матриц В-С-В
siso_SS = control.ss(task4_A, task4_B, task4_C, [0])

# Симуляция
small_ts = ts[:5000]
siso_SS_y = control.forced_response(siso_SS, U=1, X0=[0, 0], T=small_ts).outputs
\end{minted}

\subsubsection{Результаты}


\newpage
\subsection{Задание 5. Многоканальная система в форме вход-состояние-выход.}
\subsubsection{Теория}
Необходимо промоделировать MIMO систему в формате SS:
\[ 
    \begin{cases}
        \dot{x} = Ax + Bu \\
        y = Cx + Du \\
    \end{cases},
\]
где:

\[ 
    A = \begin{bmatrix}
        0 &  -9 \\
        1 &  -6 
        \end{bmatrix};
        B = \begin{bmatrix}
            1 & 4 \\
            3 & 5
            \end{bmatrix};
        C = \begin{bmatrix}
            2 & 7 \\
            4 & 6
            \end{bmatrix};
        D = \begin{bmatrix}
            0
            \end{bmatrix};
\]

\subsubsection{Программная реализация}
\begin{minted}[linenos, fontsize=\footnotesize,numbersep=5pt, frame=lines, framesep=2mm]{python}
# Создание системы из матриц В-С-В
mimo_SS = control.ss(task5_A, task5_B, task5_C, 0)

# Симуляция
mimo_SS_y = control.forced_response(mimo_SS, U=mimo_Us, X0=[0, 0], T=ts).outputs
\end{minted}

\subsubsection{Результаты}


\newpage
\section{Заключение}
В процессе работы была проведена симуляция в среде Python при помощи Python Control Systems Library для SISO и MIMO систем, данных в двух основных представлениях: TF и SS.
\subsection{Выводы}
\begin{enumerate}
   \item Проведено моделирование SISO и MIMO Transfer Function систем с различным ненулевым входным воздействием.
   \item Проведено моделирование SISO и MIMO State Space систем с различным ненулевым входным воздействием.
   \item Выход системы не зависит от формы представления.
   \item Не strictly proper системы могу давать выход отличный от 0 в момент времени t = 0 при 0 начальных условиях из-за ненулевой матрицы связи~D. 
\end{enumerate}

\end{document}